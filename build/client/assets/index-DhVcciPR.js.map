{"version":3,"file":"index-DhVcciPR.js","sources":["../../../app/routes/leaderboard+/index.tsx"],"sourcesContent":["import { useState, ChangeEvent } from 'react';\nimport { LoaderFunction, json } from '@remix-run/node';\nimport { useLoaderData } from '@remix-run/react';\nimport { authSessionStorage } from '#app/utils/session.server.ts';\nimport { sessionKey } from '#app/utils/auth.server.ts';\n\nimport Sidebar from \"#app/components/Sidebar\";\n\n//API\nimport { leaderboardAPI } from '../../api/leaderboardAPI';\nimport { userAPI } from '../../api/userAPI';\n\nimport { Pagination, Box, Typography, IconButton } from '@mui/material';\nimport { FaArrowLeft, FaArrowRight } from \"react-icons/fa\";\n\n//IsMobile\nimport { isMobile } from 'react-device-detect';\n\n//Interface\ninterface LeaderboardData {\n    topMonthlyReturns: {\n            position: number;\n            username: string;\n            score: number;\n    }[],\n    topTotalReturns: {\n        position: number;\n        username: string;\n        score: number;\n    }[],\n    topMonthlyTrades: {\n        position: number;\n        username: string;\n        score: number;\n    }[],\n    topTotalTrades: {\n        position: number;\n        username: string;\n        score: number;\n    }[],\n}\n\ninterface UserPlacement {\n    id: number;\n    username: string;\n    amount: number;\n    date: string;\n}\n\nexport const loader: LoaderFunction = async ({ request }) => {\n\n    //See if we are logged in by checking the session\n    const authSession = await authSessionStorage.getSession(\n          request.headers.get('cookie'),\n      )\n    const session = authSession.get(sessionKey);\n     \n    if (session) {\n        //Get User\n        const user = await userAPI.checklogintoken(session);\n\n        //Leaderboard\n        const leaderboard = await leaderboardAPI.getLeaderboard(session);\n\n        if (user) {\n            return json({ leaderboard: leaderboard.data, session, role: user.role, username: user.username });    \n        }\n        else {\n            return json({ leaderboard: leaderboard.data, session: null, role: null });\n        }\n    }\n    else {\n\n        //Leaderboard\n        const leaderboard = await leaderboardAPI.getLeaderboard(null);\n\n        return json({ leaderboard: leaderboard.data, session: null, role: null });\n    }\n}\n\nconst Leaderboard = () => {\n    const { leaderboard, session, role, username } = useLoaderData<{ leaderboard: LeaderboardData, session: string, role: string, username: string }>();\n    const [activeTab, setActiveTab] = useState('tab1');\n    const [sidebarOpen, setSidebarOpen] = useState(false);\n\n    const handleTabClick = (tab: string) => {\n        setActiveTab(tab);\n    };\n\n    let totalProfitsBoard = leaderboard.topTotalReturns;\n    let monthlyProfitsBoard = leaderboard.topMonthlyReturns;\n    let totalTransactionsBoard = leaderboard.topTotalTrades;\n    let monthlyTransactionsBoard = leaderboard.topMonthlyTrades;\n\n    if (session) {\n        return (\n            <div className=\"flex flex-col sm:flex-row bg-gray-200\">\n                <Sidebar sidebarOpen={sidebarOpen} setSidebarOpen={setSidebarOpen} userRole={role}/>\n                <div className=\"container mx-auto p-4\">\n                    <h1 className=\"text-3xl font-bold mb-4 text-center\">Leaderboard</h1>\n                    <div className=\"flex justify-center mb-4 lg:space-x-4\">\n                        <button\n                            className={`px-4 py-2 rounded ${activeTab === 'tab1' ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700'}`}\n                            onClick={() => handleTabClick('tab1')}\n                        >\n                            Monthly Profits\n                        </button>\n                        <button\n                            className={`px-4 py-2 rounded ${activeTab === 'tab2' ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700'}`}\n                            onClick={() => handleTabClick('tab2')}\n                        >\n                            Total Profits\n                        </button>\n                        <button\n                            className={`px-4 py-2 rounded ${activeTab === 'tab3' ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700'}`}\n                            onClick={() => handleTabClick('tab3')}\n                        >\n                            Monthly Transactions\n                        </button>\n                        <button\n                            className={`px-4 py-2 rounded ${activeTab === 'tab4' ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700'}`}\n                            onClick={() => handleTabClick('tab4')}\n                        >\n                            Total Transactions\n                        </button>\n                    </div>\n                    <div className=\"bg-white p-4 rounded-lg shadow-md\">\n                        {activeTab === 'tab1' && <TabContent title=\"Monthly Profits Leaderboard\" data={monthlyProfitsBoard} username={username}/>}\n                        {activeTab === 'tab2' && <TabContent title=\"Total Profits Leaderboard\" data={totalProfitsBoard} username={username}/>}\n                        {activeTab === 'tab3' && <TabContent title=\"Monthly Transactions Leaderboard\" data={monthlyTransactionsBoard} username={username}/>}\n                        {activeTab === 'tab4' && <TabContent title=\"Total Transactions Leaderboard\" data={totalTransactionsBoard} username={username}/>}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    else {\n        return (\n            <div className=\"container mx-auto p-4\">\n                <h1 className=\"text-3xl font-bold mb-4 text-center\">Leaderboard</h1>\n                <div className=\"flex justify-center mb-4 lg:space-x-4\">\n                    <button\n                        className={`px-4 py-2 rounded ${activeTab === 'tab1' ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700'}`}\n                        onClick={() => handleTabClick('tab1')}\n                    >\n                        Weekly Profits\n                    </button>\n                    <button\n                        className={`px-4 py-2 rounded ${activeTab === 'tab2' ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700'}`}\n                        onClick={() => handleTabClick('tab2')}\n                    >\n                        Total Profits\n                    </button>\n                    <button\n                        className={`px-4 py-2 rounded ${activeTab === 'tab3' ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700'}`}\n                        onClick={() => handleTabClick('tab3')}\n                    >\n                        Weekly Transactions\n                    </button>\n                    <button\n                        className={`px-4 py-2 rounded ${activeTab === 'tab4' ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700'}`}\n                        onClick={() => handleTabClick('tab4')}\n                    >\n                        Total Transactions\n                    </button>\n                </div>\n                <div className=\"bg-white p-4 rounded-lg shadow-md\">\n                    {activeTab === 'tab1' && <TabContent title=\"Monthly Profits Leaderboard\" data={monthlyProfitsBoard} />}\n                    {activeTab === 'tab2' && <TabContent title=\"Total Profits Leaderboard\" data={totalProfitsBoard} />}\n                    {activeTab === 'tab3' && <TabContent title=\"Monthly Transactions Leaderboard\" data={monthlyTransactionsBoard}/>}\n                    {activeTab === 'tab4' && <TabContent title=\"Total Transactions Leaderboard\" data={totalTransactionsBoard}/>}\n                </div>\n            </div>\n        );\n    }\n};\n\nconst applyPagination = (\n    data: { position: number; username: string; score: number }[],\n    page: number,\n    limit: number\n) => {\n    return data.slice(page * limit, page * limit + limit);\n};\n\nconst TabContent = ({ title, data, username }: { title: string; data: { position: number; username: string; score: number }[]; username: string; }) => {\n\n    const [page, setPage] = useState(1);\n    const limit = 10;\n    const totalPages = Math.ceil(data.length / limit);\n\n    const handlePreviousPage = () => {\n        if (page > 1) {\n          setPage(page - 1);\n        }\n      };\n    \n    const handleNextPage = () => {\n        if (page < totalPages) {\n            setPage(page + 1);\n        }\n    };\n\n    const paginatedData = applyPagination(data, page - 1, limit);\n\n    return (\n        <div>\n          <h2 className=\"text-xl font-bold mb-4\">{title}</h2>\n          <div className=\"overflow-y-auto\">\n            <ul className=\"space-y-2\">\n              {paginatedData.map((user, index) => (\n                <li\n                    key={user.position}\n                    className={`flex items-center justify-between p-4 rounded-lg shadow-md ${user.username === username ? 'bg-red-500 text-white' : index % 2 === 0 ? 'bg-gray-100' : 'bg-white'}`}\n                >\n                  <div className=\"flex items-center space-x-4\">\n                    <span className=\"text-md font-bold\">{user.position}</span>\n                    <span className=\"text-md\">{user.username}</span>\n                  </div>\n                  <span className=\"text-md font-semibold\">{title.includes(\"Profits\") ? '$' : ''}{user.score}</span>\n                </li>\n              ))}\n            </ul>\n          </div>\n          <Box display=\"flex\" alignItems=\"center\" justifyContent=\"center\" mt={4}>\n            <div className=\"flex mt-5 flex-row gap-2 justify-center\">\n                <IconButton onClick={handlePreviousPage} disabled={page === 1}>\n                    <FaArrowLeft />\n                </IconButton>\n                <Typography variant=\"body1\" mx={2}>\n                    Page {page} of {totalPages}\n                </Typography>\n                <IconButton onClick={handleNextPage} disabled={page === totalPages}>\n                    <FaArrowRight />\n                </IconButton>\n            </div>\n          </Box>\n        </div>\n    );\n};\n\nexport default Leaderboard;"],"names":["Leaderboard","leaderboard","session","role","username","useLoaderData","activeTab","setActiveTab","useState","sidebarOpen","setSidebarOpen","handleTabClick","tab","totalProfitsBoard","topTotalReturns","monthlyProfitsBoard","topMonthlyReturns","totalTransactionsBoard","topTotalTrades","monthlyTransactionsBoard","topMonthlyTrades","jsxs","className","children","jsx","Sidebar","userRole","onClick","TabContent","title","data","applyPagination","page","limit","slice","setPage","totalPages","Math","ceil","length","handlePreviousPage","handleNextPage","paginatedData","map","user","index","position","includes","score","Box","display","alignItems","justifyContent","mt","IconButton","disabled","FaArrowLeft","Typography","variant","mx","FaArrowRight","Leaderboard$1"],"mappings":"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"}