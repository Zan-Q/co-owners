import{r as B,j as e}from"./jsx-runtime-D2HyDbKh.js";import{z as s}from"./index-BeXw7Xwl.js";import{u as C,g as D,E as S,a as w}from"./forms-pZ2rD6vG.js";import{B as F}from"./button-BTFmWHin.js";import{I as n}from"./icon-CldSu2rP.js";import{S as P}from"./status-button-jM1d2HtI.js";import{a as E,u as z,g as A}from"./misc-D_OAexT3.js";import{b as U,a as k,F as L}from"./components-7CkHrf4S.js";import{n as T}from"./index-PxjvPj8E.js";import{g as Z}from"./constraint-Bik5U1QS.js";import{p as q}from"./parse-C-ev3aC7.js";import"./submission-BBd9SSur.js";import"./index-tx3aR2qd.js";import"./index-4Ns2fbOC.js";import"./tooltip-DXoIDLmn.js";import"./clsx-B-dksMZM.js";import"./index-Cd_vq22D.js";const le={breadcrumb:e.jsx(n,{name:"avatar",children:"Photo"}),getSitemapEntries:()=>null},M=1024*1024*3,O=s.object({intent:s.literal("delete")}),V=s.object({intent:s.literal("submit"),photoFile:s.instanceof(File).refine(t=>t.size>0,"Image is required").refine(t=>t.size<=M,"Image size must be less than 3MB")}),N=s.discriminatedUnion("intent",[O,V]);function me(){var p,h,g,f;const t=U(),l=E(),a=k(),R=T(),[r,i]=C({id:"profile-photo",constraint:Z(N),lastResult:a==null?void 0:a.result,onValidate({formData:o}){return q(o,{schema:N})},shouldRevalidate:"onBlur"}),m=z()?(p=R.formData)==null?void 0:p.get("intent"):null,d=i.intent.value,[u,c]=B.useState(null);return e.jsx("div",{children:e.jsxs(L,{method:"POST",encType:"multipart/form-data",className:"flex flex-col items-center justify-center gap-10",onReset:()=>c(null),...D(r),children:[e.jsx("img",{src:u??(t.user?A(t.user.imageUrl):""),className:"h-52 w-52 rounded-full object-cover",alt:((h=t.user)==null?void 0:h.name)??((g=t.user)==null?void 0:g.username)}),e.jsx(S,{errors:i.photoFile.errors,id:i.photoFile.id}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{...w(i.photoFile,{type:"file"}),accept:"image/*",className:"peer sr-only",required:!0,tabIndex:u?-1:0,onChange:o=>{var j;const x=(j=o.currentTarget.files)==null?void 0:j[0];if(x){const b=new FileReader;b.onload=y=>{var v,I;c(((I=(v=y.target)==null?void 0:v.result)==null?void 0:I.toString())??null)},b.readAsDataURL(x)}}}),e.jsx(F,{asChild:!0,className:"cursor-pointer peer-valid:hidden peer-focus-within:ring-2 peer-focus-visible:ring-2",children:e.jsx("label",{htmlFor:i.photoFile.id,children:e.jsx(n,{name:"pencil-1",children:"Change"})})}),e.jsx(P,{name:"intent",value:"submit",type:"submit",className:"peer-invalid:hidden",status:m==="submit"?"pending":d==="submit"?r.status??"idle":"idle",children:"Save Photo"}),e.jsx(F,{variant:"destructive",className:"peer-invalid:hidden",...r.reset.getButtonProps(),children:e.jsx(n,{name:"trash",children:"Reset"})}),(f=t.user.image)!=null&&f.id?e.jsx(P,{className:"peer-valid:hidden",variant:"destructive",...l.getButtonProps({type:"submit",name:"intent",value:"delete"}),status:m==="delete"?"pending":d==="delete"?r.status??"idle":"idle",children:e.jsx(n,{name:"trash",children:l.doubleCheck?"Are you sure?":"Delete"})}):null]}),e.jsx(S,{errors:r.errors})]})})}export{me as default,le as handle};
//# sourceMappingURL=profile.photo-MlkfTEEi.js.map
